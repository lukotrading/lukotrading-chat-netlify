
<!-- Plak dit in een HTML/Embed-blok in JouwWeb -->
<div id="luko-chat" style="max-width:420px;border:1px solid #e5e7eb;border-radius:14px;padding:12px;font-family:system-ui;box-shadow:0 6px 16px rgba(0,0,0,.06)">
  <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px">
    <strong>Vraag het aan Lukotrading</strong>
  </div>
  <div id="log" style="height:280px;overflow:auto;background:#fafafa;border-radius:10px;padding:10px"></div>
  <form id="luko-form" style="display:flex;gap:8px;margin-top:8px">
    <input id="q" placeholder="Stel je vraag over Innolabâ€¦" style="flex:1;padding:10px;border:1px solid #d1d5db;border-radius:10px">
    <button style="padding:10px 14px;border:0;border-radius:10px;background:#0ea5e9;color:#fff;cursor:pointer">Stuur</button>
  </form>
  <small style="color:#6b7280;display:block;margin-top:6px">Antwoorden kunnen beknopt zijn; voor advies mail ons: info@lukotrading.com</small>
</div>

<script>
(() => {
  const BACKEND = "/api/chat"; // dankzij redirect in netlify.toml

  const log = document.getElementById("log");
  const f = document.getElementById("luko-form");
  const q = document.getElementById("q");
  const history = [
    { role:"system", content:
      "Je bent de productassistent van Lukotrading. Antwoord kort, duidelijk en praktisch. "+
      "Noem doseringen/inwerktijden alleen indien relevant. Veiligheid eerst. "+
      "Als iets onbekend is, zeg dat eerlijk en verwijs naar info@lukotrading.com."
    }
  ];
  function add(role, text){
    const wrap = document.createElement("div");
    wrap.style.margin = "6px 0";
    wrap.innerHTML = `<div style=\"padding:8px;border-radius:10px;${role==='user'?'background:#e0f2fe;':'background:#fff;'}\">
      <strong>${role==='user'?'U':'Lukotrading'}:</strong> ${text}
    </div>`;
    log.appendChild(wrap); log.scrollTop = log.scrollHeight;
  }
  f.addEventListener("submit", async (e)=>{
    e.preventDefault();
    const text = q.value.trim(); if(!text) return;
    add("user", text); q.value="";
    history.push({role:"user", content:text});

    try{
      const resp = await fetch(BACKEND, {
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify({ messages: history })
      });
      const aiText = await resp.text();
      add("assistant", aiText || "(Geen antwoord)");
      history.push({role:"assistant", content: aiText});
    }catch(err){
      add("assistant", "(Er ging iets mis met de verbinding.)");
    }
  });
})();
</script>
